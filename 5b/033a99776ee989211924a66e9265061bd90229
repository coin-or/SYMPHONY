r877 branches/heuristics